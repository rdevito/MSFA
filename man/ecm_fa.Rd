% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/MSFA_R.R
\name{ecm_fa}
\alias{ecm_fa}
\title{Estimates the parameters of study-specific FA models}
\usage{
ecm_fa(
  X_s,
  tot_s,
  nIt = 50000,
  tol = 10^-7,
  block_lower = TRUE,
  robust = FALSE,
  corr = TRUE,
  mcd = FALSE,
  trace = TRUE,
  traceIT = 1000
)
}
\arguments{
\item{X_s}{List of lenght \eqn{S}{S}, corresponding to number of different studies considered.
Each element of the list contains a data matrix, with the same number of columns \eqn{P}{P} for all the studies.}

\item{tot_s}{Number of latent factors for each study. A vector of positive integers of length \eqn{S}{S}.}

\item{nIt}{Maximum number of iterations for the ECM algorithm. Default is 50000.}

\item{tol}{Tolerance for declaring convergence of the ECM algorithm. Default is 10^-7.}

\item{block_lower}{Should the upper-triangular zero constraint be enforced? Default is \code{TRUE}
(strongly suggested).}

\item{robust}{If \code{TRUE}, robust covariance matrix is used in place of the sample covariance. Default
is \code{FALSE}.}

\item{corr}{If \code{TRUE}, the analysis will employ the correlation matrix instead of the covariance matrix.}

\item{mcd}{If \code{TRUE}, the robust estimator used for the covariance is the same proposed in Pison et al. (2003),
otherwise the default value of the function \code{CovRob} of the \code{robust} library is employed. Default is
\code{FALSE}.}

\item{trace}{If \code{TRUE} then trace information is being printed every \code{traceIT} iterations of the ECM algorithm.}

\item{traceIT}{Frequency of tracing information.}
}
\value{
A list  containing the following components:
\item{\code{Omega_s}, \code{Psi_s}}{the estimated model matrices.}
\item{loglik}{the value of the log likelihood function at the final estimates.}
\item{\code{AIC, BIC}}{model selection criteria at the estimate.}
\item{\code{npar}}{number of model parameters.}
\item{iter}{the number of ECM iterations performed.}
}
\description{
Maximum likelihood estimation of study-specific FA models parameters via the ECM
algorithm, adopting the upper-triangular zero constraint to achieve identification
for each loading matrix. Note: the function can also estimate a FA model for a single
study, by specifiyng \code{X_s = list(data)}, where \code{data} is the data matrix.
}
\references{
De Vito, R., Bellio, R., Trippa, L. and Parmigiani, G. (2019). Multi-study Factor Analysis. Biometrics,  75, 337-346.

Pison, G., Rousseeuw, P.J., Filzmoser, P. and Croux, C. (2003). Robust factor analysis. Journal
Multivariate Analysis, 84, 145-172.
}
